<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="style2.css">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Applications</title>
	<style>
		table {
		  overflow-x: auto;
		  display: block;
		}

		th, td {
		  min-width: 120px;
		  padding: 8px;
		  text-align: left;
		}

		@media screen and (max-width: 768px) {
		  th, td {
		    min-width: 80px;
		  }
		}
	</style>
</head>
<body>
  <div class="sidebar">
		<h2><a href="Index.html"> Menu </a></h2>
		<ul>
			<li><a href="vacantrooms.html">Allocate Rooms</a></li>
			<li><a href="allresidents.html">Hostalites</a></li>
            <li><a href="newapplications.html">New Applications</a></li>
			<li><a href="wardeninformation.html">View profile</a></li>
			<li><a href="#">Complaints</a></li>
			<li><button id="logout-btn" onclick="logOut()">Log Out</button></li>
		</ul>
	</div>
	<div class="main">
        <table  id="card8">
            <thead>
                <tr>
                  <th>Resident id</th>
                    <th>Resident Name</th>
                    <th>Course Type</th>
                    <th>Resident  Course</th>
                    <th>Room No</th>
                    <th>Sex</th>
                    <th>Aadhar</th>
                    <th>Address</th>
                    <th>Contact</th>
                    <th>Distance</th>
                    <th>Photo</th>
                    <th>Email</th>
                    <th>Medical Certificate</th>
                    <th>Bonified Certificate</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Archive</th>
                </tr>
                <tr>
                  <td id="resident_id"></td>
                  <td id="resident_Name"></td>
                  <td id="course_type"></td>
                  <td id="resident_course"></td>
                  <td id="room_no"></td>
                  <td id="sex"></td>
                  <td id="aadhar"></td>
                  <td id="address"></td>
                  <td id="contact"></td>
                  <td id="distance"></td>
                  <td id="photo"></td>
                  <td id="email"></td>
                  <td id="medical_certificate"></td>
                  <td id="bonified_certificate"></td>
                  <td id="start_date"></td>
                  <td id="end_date"></td>
            </thead>
            <tbody>
         
                <!-- add more rows as needed -->
            </tbody>
        </table>
	</div>
	<script src="script2.js"></script>
    <script>
        // Get the table body element
// get the table element by ID
var table = document.getElementById("card8");

// create an array of dummy data objects
let dummyData = []
fetch('http://127.0.0.1:8080/api/warden/getAllResidents', {
  method: "get", // *GET, POST, PUT, DELETE, etc.
  cache: "no-cache", // *default, no-cache, reload, force-cache, only-if-cached
  headers: {
    "Content-Type": "application/json",
    // 'Content-Type': 'application/x-www-form-urlencoded',
  },
  redirect: "follow", // manual, *follow, error
  referrerPolicy: "no-referrer",
}).then(response => {
  if (response.ok) {
    if (response.ok) {
      return response.json();
    }
  } else {
    // Display error message

  }
}).then((responseJson) => {
  dummyData = responseJson;
  // iterate over the dummy data and create a new row for each object
for (var i = 0; i < dummyData.length; i++) {
  // create a new row for the current object
  var row = table.insertRow(-1);

  // create cells for each field in the row
  var idCell = row.insertCell(0);
  var nameCell = row.insertCell(1);
  var typeCell = row.insertCell(2);
  var courseCell = row.insertCell(3);
  var roomNoCell = row.insertCell(4);
  var sexCell = row.insertCell(5);
  var aadharCell = row.insertCell(6);
  var addressCell = row.insertCell(7);
  var contactCell = row.insertCell(8);
  var distanceCell = row.insertCell(9);
  var photoCell = row.insertCell(10);
  var emailCell = row.insertCell(11);
  var medicalCell = row.insertCell(12);
  var bonifiedCell = row.insertCell(13);
  var startCell = row.insertCell(14);
  var endCell = row.insertCell(15);


  // add the data from the current object to the cells
  idCell.innerHTML = dummyData[i].hostel_resident_id;
  nameCell.innerHTML = dummyData[i].hostel_resident_name;
  typeCell.innerHTML = dummyData[i].course_type;
  courseCell.innerHTML = dummyData[i].hostel_resident_course;
  roomNoCell.innerHTML = dummyData[i].room_no;
  sexCell.innerHTML = dummyData[i].sex;
  aadharCell.innerHTML = dummyData[i].aadhar;
  addressCell.innerHTML = dummyData[i].address;
  contactCell.innerHTML = dummyData[i].contact;
  distanceCell.innerHTML = dummyData[i].distance;
  photoCell.innerHTML = '<img src="' + dummyData[i].photo + '">';
  emailCell.innerHTML = dummyData[i].email;
  medicalCell.innerHTML = dummyData[i].medical_certificate;
  bonifiedCell.innerHTML = dummyData[i].bonified_certificate;
  startCell.innerHTML = dummyData[i].start_date;
  endCell.innerHTML = dummyData[i].end_date;
  //addButtonsToTable(i+2);
}
})
  .catch(error => {
    console.log(error);
  });
  

const  addButtonsToTable=(i)=> {
    console.log(i);
      var table = document.getElementById("card8");
      var rows = table.rows;
        var cell = rows[i].insertCell(-1);
        var Archive = document.createElement("button");
        Archive.textContent = "Archive";
        var value="Archive";
        var residentId = this.parentNode.parentNode.cells[0].textContent;
        Archive.onclick = archiveResident (residentId,"Archive") 
        cell.appendChild(Archive);

      }
// Function to archive a resident
function archiveResident(residentId,status) {
  // Make an API call to your backend to archive the resident data based on the resident_id
  // For example, you can use the fetch() method to make a POST request to an endpoint like /archiveResident with the resident_id as a parameter
  // Once the resident data is successfully archived, you can remove the corresponding row from the table using the remove() method

  // Get the row element for the resident and remove it from the table
  // var row = document.querySelector(`tr[data-resident-id="${residentId}"]`);
  // row.remove();
}

// Function to fetch the resident data from the database and add it to the table
// function loadResidents() {
//   // Make an API call to your backend to get the resident data from the database
//   // For example, you can use the fetch() method to make a GET request to an endpoint like /getResidents
//   // The API response should return a JSON array of resident objects
//   fetch('/http://127.0.0.1:8080/api/warden/getAllResidents/',{
//     method: "get", // *GET, POST, PUT, DELETE, etc.
//       cache: "no-cache", // *default, no-cache, reload, force-cache, only-if-cached
//       headers: {
//         "Content-Type": "application/json",
//         // 'Content-Type': 'application/x-www-form-urlencoded',
//       },
//       redirect: "follow", // manual, *follow, error
//       referrerPolicy: "no-referrer",
//     })
//     .then(response => response.json())
//     .then(residents => {
//       // Loop through the residents and add them to the table
//       residents.forEach(resident => {
//         addTableRow(resident);

//         // Add a data-resident-id attribute to the row for easy reference when archiving the resident
//         var row = tableBody.lastChild;
//         row.setAttribute('data-resident-id', resident.resident_id);
//       });
//     });
// }

// // Call the loadResidents() function to fetch and display the resident data in the table
// loadResidents();

</script>
    
</body>
</html>